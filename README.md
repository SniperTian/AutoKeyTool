# 🚀 AutoKey Tool

**AutoKey Tool** 是一款现代化的、轻量级的 Windows 自动化工具。它集成了键盘宏执行、鼠标连点器以及强大的后台窗口绑定(画饼)功能，旨在帮助用户从繁琐的重复操作中解脱出来。

采用 Python + PyQt6 开发，拥有清爽的 MVVM 架构 UI，支持配置文件的导入导出。

---

## ✨ 核心特性

* **🖥️ 现代化 UI**: 基于 PyQt6 构建的清爽界面。
* **🔒 后台执行**: 支持 **窗口绑定 (Window Binding)** 模式。绑定句柄后，即使目标窗口被遮挡或最小化，依然可以向其发送按键指令（基于 Win32 API）。
* **⌨️ 键盘自动化**:
* 支持编辑按键序列（如 `Ctrl+C`, `Alt+Tab`等）。
* 自定义每个动作的延迟时间。
* 支持无限循环或指定次数循环。


* **🖱️ 鼠标连点器**:
* 支持左键/右键。
* 支持单击/双击模式。
* 支持 CPS (点击/秒) 调节，最高支持 1000 次/秒。


* **⚡ 全局热键**:
* **F9**: 启动任务
* **F10**: 停止任务
* **F11**: 智能绑定当前前台窗口


* **💾 配置管理**: 支持保存和加载 `.json` 配置文件，方便分享和备份方案。
* **📥 托盘模式**: 支持最小化到系统托盘，保持桌面整洁。

---

## 🛠️ 安装与运行

### 环境要求

* Windows 7/ 10 / 11
* Python 3.8+

### 1. 克隆仓库

```bash
git clone https://github.com/SniperTian/AutoKeyTool.git
cd AutoKeyTool

```

### 2. 安装依赖

建议使用虚拟环境：

```bash
# 创建虚拟环境
conda create -n autokey python=3.8
# 激活环境
conda activate autokey

# 安装依赖
pip install -r requirements.txt

```

### 3. 运行源码

```bash
python main.py

```

---

## 📦 打包发布 (exe)

如果你想将其打包为独立的 `.exe` 可执行文件分享给朋友，可以使用 `pyinstaller`：

```bash
pip install pyinstaller
pyinstaller -F -w -n "AutoKeyPro" -i "icon.ico" main.py

```

*(注：`-F` 表示单文件，`-w` 表示隐藏控制台窗口)*

---

## 📖 使用指南

### 1. 键盘自动化模式

1. **添加动作**：点击“➕ 添加”按钮，双击单元格可修改按键内容（支持录制）和延迟时间。
2. **调整顺序**：选中行后点击“⬆️”或“⬇️”调整执行顺序。
3. **设置循环**：在上方设置循环次数，`0` 表示无限循环。
4. **启动**：点击“开始运行”或按下 **F9**。

### 2. 鼠标连点器模式

1. 切换到“🖱️ 鼠标连点器”选项卡。
2. 设置按键类型（左键/右键）和点击方式（单击/双击）。
3. 设置点击速度（次/秒）。
4. **提示**：鼠标模式与键盘模式共享启动/停止热键。

### 3. 后台挂机 (窗口绑定) ✨

这是本工具最强大的功能：

1. 打开你需要挂机的游戏或软件窗口。
2. 确保该窗口处于前台激活状态。
3. 按下热键 **F11**。
4. 软件会自动获取该窗口的句柄，并弹出“绑定成功”提示。
5. 此时你可以最小化该窗口，按下 **F9** 启动，AutoKey 将在后台向该窗口发送指令，不影响你做其他事情。

---

## 📂 项目结构

```text
AutoKeyTool/
├── main.py              # 程序入口，主窗口逻辑
├── gui.py               # UI 界面布局与样式定义 (PyQt6)
├── executor.py          # 任务执行引擎 (多线程管理)
├── hotkey.py            # 全局热键管理器
├── utils.py             # 工具类 (Win32 API封装, 图标绘制, 文本处理)
├── config.py            # 配置读写管理器
├── default_config.json  # 默认配置文件
└── requirements.txt     # 项目依赖

```

---

## 🤝 贡献与反馈

欢迎提交 Issue 或 Pull Request！

* **TODO**: 完善“操作录制”模式，实现基于 Hook 的键鼠动作全记录。
* **TODO**: 增加脚本逻辑支持（如 `if color then click`）。

---

## ⚠️ 免责声明

本软件仅供学习交流和个人辅助使用。

* 请勿用于网络游戏中违反公平性的行为。
* 请勿用于恶意攻击或破坏计算机系统。
* 作者不对使用本软件产生的任何后果负责。

---

## 📄 License

本项目基于 [MIT License](https://www.google.com/search?q=LICENSE) 开源。